---
title: "Lab grade analysis"
autor: "Hugo Sparrman"
format: html
editor: visual
echo: false 
---


```{r}
library(here)
here::i_am("r-101-grade-analysis.Rproj")
library(tidyr)
library(dplyr)
library(vroom)
library(ggplot2)
```

## Question 1

```{r}
grades <- vroom(here("grades.csv"))
```

## Question 2 

```{r, message=FALSE}
summary_grades<-grades|>
  summarise(Mean = mean(Exam, na.rm = T),
            Median = median(Exam, na.rm = T),
            Min = min(Exam, na.rm = T),
            Max = max(Exam, na.rm = T))

knitr::kable(summary_grades, caption = "Summary statistics of the exam grades")
```

## Question 3 

```{r}
skipping_class<-grades|>
  filter(is.na(Exam))|>nrow()
```

`r skipping_class` did not go to the exam.

## Question 4 

```{r}
grades|>
  drop_na(Exam)|>
  ggplot(aes(x = Exam))+
  geom_bar()+
  xlab("Exam Score")+
  ylab("Count")+
  ggtitle("Exam grade distribution")

```
## Question 5

```{r}
n_students <- grades|>
  group_by(Group)|>
  summarise(N = n())
knitr::kable(n_students, caption = "Number of students in each group")
```

## Quetion 6

```{r}
n_students|>
  ggplot(aes(x = Group, y = N))+
  geom_col()+
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
```

## Question 7 

```{r}
grades|> drop_na(Exam)|>
  ggplot(aes(x = Group, y = Exam))+
  geom_boxplot()+
  ggtitle("Conditional grade distribution")+
   theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1),
        plot.title = element_text(hjust=0.5))
```


```{r}
grades|> drop_na(Exam)|>
  ggplot(aes(x = Group, y = Exam))+
  geom_violin()+
  ggtitle("Conditional grade distribution")+
   theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1),
        plot.title = element_text(hjust=0.5))
```

## Question 8 

```{r}
grades|>
  group_by(Group)|>
  summarise("Missed Exam Count"=sum(is.na(Exam))) 

```

```{r}
grades|>
  group_by(Group)|>
  summarise("Missed Exam Count"=sum(is.na(Exam)))|>
  ggplot(aes(y = `Missed Exam Count`,x = Group))+
  geom_col()+
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
```


